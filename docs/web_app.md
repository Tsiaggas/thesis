# Τεκμηρίωση Διαδικτυακής Εφαρμογής

Η διαδικτυακή εφαρμογή ανάλυσης συναισθήματος έχει αναπτυχθεί με το Flask framework και παρέχει ένα φιλικό προς το χρήστη interface για την ανάλυση ελληνικών κειμένων.

## Αρχιτεκτονική

Η εφαρμογή ακολουθεί μια απλή αρχιτεκτονική MVC (Model-View-Controller):

- **Model**: Το fine-tuned BERT μοντέλο που φορτώνεται μέσω της βιβλιοθήκης Transformers
- **View**: Τα HTML templates με CSS και JavaScript για το frontend
- **Controller**: Το Flask application που διαχειρίζεται τα requests και τα responses

## Δομή Φακέλων

```
web_app/
├── app.py                 # Κύριο αρχείο εφαρμογής Flask
├── templates/             # HTML templates
│   ├── home.html          # Αρχική σελίδα
│   ├── about.html         # Σελίδα πληροφοριών
│   └── base.html          # Βασικό template
├── static/                # Στατικά αρχεία
│   ├── css/               # CSS styles
│   ├── js/                # JavaScript
│   └── img/               # Εικόνες
├── uploads/               # Προσωρινά αρχεία για ανάλυση
└── utils/                 # Βοηθητικά scripts
```

## Endpoints

Η εφαρμογή εκθέτει τα ακόλουθα endpoints:

1. **GET /** - Αρχική σελίδα με φόρμα για ανάλυση κειμένου
2. **POST /analyze** - Endpoint για ανάλυση μεμονωμένου κειμένου
3. **POST /analyze_batch** - Endpoint για ανάλυση αρχείου CSV
4. **GET /about** - Σελίδα πληροφοριών για την εφαρμογή

## Κύρια Λειτουργικότητα

### 1. Φόρτωση Μοντέλου

Κατά την εκκίνηση της εφαρμογής, το fine-tuned BERT μοντέλο φορτώνεται από τον φάκελο `models/fine_tuned_bert/` ως pipeline της βιβλιοθήκης Transformers:

```python
tokenizer = AutoTokenizer.from_pretrained(model_dir)
model = AutoModelForSequenceClassification.from_pretrained(model_dir)

# Έλεγχος για GPU
device = 0 if torch.cuda.is_available() else -1

sentiment_pipeline = pipeline(
    "sentiment-analysis", 
    model=model, 
    tokenizer=tokenizer, 
    device=device,
    return_all_scores=True
)
```

### 2. Ανάλυση Μεμονωμένου Κειμένου

Το endpoint `/analyze`:

1. Δέχεται το κείμενο από τη φόρμα
2. Τροφοδοτεί το κείμενο στο pipeline
3. Επεξεργάζεται την έξοδο του pipeline για εξαγωγή ετικέτας και πιθανότητας
4. Δημιουργεί ένα γράφημα Plotly με τις πιθανότητες
5. Επιστρέφει τα αποτελέσματα ως JSON

### 3. Ανάλυση Αρχείου CSV

Το endpoint `/analyze_batch`:

1. Δέχεται αρχείο CSV με στήλη κειμένου
2. Επεξεργάζεται το αρχείο για να εξαγάγει τα κείμενα
3. Εκτελεί την ανάλυση συναισθήματος σε batches
4. Συλλέγει και οργανώνει τα αποτελέσματα
5. Δημιουργεί γράφημα κατανομής συναισθημάτων
6. Επιστρέφει συνολικά αποτελέσματα και στατιστικά ως JSON

## Διαδικασία Επεξεργασίας

Η διαδικασία επεξεργασίας ενός αιτήματος ανάλυσης κειμένου ακολουθεί τα εξής βήματα:

1. **Αίτημα**: Ο χρήστης υποβάλλει κείμενο ή αρχείο CSV.
2. **Προεπεξεργασία**: Το κείμενο ελέγχεται αν είναι έγκυρο.
3. **Tokenization**: Το tokenizer μετατρέπει το κείμενο σε tokens.
4. **Πρόβλεψη**: Το μοντέλο BERT εκτελεί την πρόβλεψη.
5. **Επεξεργασία**: Η έξοδος του μοντέλου μετατρέπεται σε ετικέτες και πιθανότητες.
6. **Οπτικοποίηση**: Δημιουργούνται γραφήματα Plotly για τις πιθανότητες.
7. **Απάντηση**: Επιστρέφεται JSON στο frontend.
8. **Εμφάνιση**: Το JavaScript διαχειρίζεται την εμφάνιση των αποτελεσμάτων.

## Frontend

Το frontend της εφαρμογής είναι κατασκευασμένο με:

- **Bootstrap** για το responsive design
- **jQuery** για AJAX και DOM manipulation
- **Plotly.js** για τα διαδραστικά γραφήματα

### Χειρισμός AJAX

Το JavaScript στο `home.html` διαχειρίζεται τις κλήσεις AJAX προς το backend για την ανάλυση:

1. Συλλέγει δεδομένα από τη φόρμα
2. Στέλνει POST αίτημα στο `/analyze` ή `/analyze_batch`
3. Λαμβάνει και αποκωδικοποιεί την απάντηση JSON
4. Ενημερώνει το DOM με τα αποτελέσματα
5. Αναπαράγει τα γραφήματα Plotly

### Χειρισμός Σφαλμάτων

Το frontend και το backend έχουν μηχανισμούς χειρισμού σφαλμάτων:

- Έλεγχοι εγκυρότητας εισόδου
- Προσαρμοσμένα μηνύματα σφαλμάτων
- Διαχείριση περιπτώσεων μη διαθεσιμότητας του μοντέλου
- Timeout για μεγάλες αναλύσεις

## Εκτέλεση της Εφαρμογής

Για να εκτελέσετε την εφαρμογή:

```bash
# Ενεργοποίηση του virtual environment
.\.venv\Scripts\activate  # Windows
source .venv/bin/activate  # Linux/Mac

# Εκτέλεση της εφαρμογής
python web_app/app.py
```

Η εφαρμογή θα είναι διαθέσιμη στη διεύθυνση: http://127.0.0.1:5000

## Επέκταση της Εφαρμογής

Για την επέκταση της εφαρμογής με νέες λειτουργίες:

1. **Νέα Endpoints**: Προσθέστε νέα routes στο `app.py`
2. **Νέα Templates**: Δημιουργήστε νέα HTML templates στον φάκελο `templates/`
3. **Νέα Στατικά Αρχεία**: Προσθέστε CSS/JS/εικόνες στον φάκελο `static/`
4. **Υποστήριξη Νέων Μοντέλων**: Προσθέστε υποστήριξη για άλλους τύπους μοντέλων

## Παράδειγμα Response JSON

```json
{
  "text": "Το προϊόν είναι εξαιρετικό!",
  "sentiment_label": "Θετικό",
  "sentiment_code": 1,
  "probability": 97.8,
  "scores": {
    "Αρνητικό": 2.2,
    "Θετικό": 97.8
  },
  "probability_chart": {
    // Δεδομένα γραφήματος Plotly
  }
}
```

## Αντιμετώπιση Προβλημάτων

- **Σφάλμα φόρτωσης μοντέλου**: Βεβαιωθείτε ότι ο φάκελος `models/fine_tuned_bert/` περιέχει όλα τα απαραίτητα αρχεία.
- **Timeout σε μεγάλα αρχεία**: Αυξήστε το timeout του server ή μειώστε το μέγεθος του batch.
- **Προβλήματα με τα γραφήματα**: Ελέγξτε ότι η βιβλιοθήκη Plotly.js φορτώνεται σωστά. 